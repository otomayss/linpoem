(self["webpackChunklin_cms_vvlog"]=self["webpackChunklin_cms_vvlog"]||[]).push([[8],{50324:function(n,t,e){var i=e(58158);n.exports=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(i)},93136:function(n,t,e){var i=e(42721),r=e(59030),a=e(17664),o=e(57036),s=e(73017),c=i(o),l=i("".slice),u=Math.ceil,d=function(n){return function(t,e,i){var o,d,m=a(s(t)),f=r(e),h=m.length,v=void 0===i?" ":a(i);return f<=h||""==v?m:(o=f-h,d=c(v,u(o/v.length)),d.length>o&&(d=l(d,0,o)),n?m+d:d+m)}};n.exports={start:d(!1),end:d(!0)}},57036:function(n,t,e){"use strict";var i=e(76628),r=e(17664),a=e(73017),o=RangeError;n.exports=function(n){var t=r(a(this)),e="",s=i(n);if(s<0||s==1/0)throw o("Wrong number of repetitions");for(;s>0;(s>>>=1)&&(t+=t))1&s&&(e+=t);return e}},52161:function(n,t,e){var i=e(5114).PROPER,r=e(242),a=e(45460),o="​᠎";n.exports=function(n){return r((function(){return!!a[n]()||o[n]()!==o||i&&a[n].name!==n}))}},85200:function(n,t,e){"use strict";var i=e(79053),r=e(93136).start,a=e(50324);i({target:"String",proto:!0,forced:a},{padStart:function(n){return r(this,n,arguments.length>1?arguments[1]:void 0)}})},98300:function(n,t,e){"use strict";var i=e(79053),r=e(49463).trim,a=e(52161);i({target:"String",proto:!0,forced:a("trim")},{trim:function(){return r(this)}})},11490:function(n,t,e){"use strict";e.d(t,{Z:function(){return R}});var i=e(6808),r=e(59511),a=e(3757),o=function(n){return(0,i.dD)("data-v-672539b3"),n=n(),(0,i.Cn)(),n},s={"element-loading-background":"rgba(0, 0, 0, 0.7)"},c={class:"dialog-header"},l=o((function(){return(0,i._)("i",{class:"el-icon-shopping-cart-2"},null,-1)})),u={class:"order-info"},d={class:"qrcode-wrapper"},m={class:"qrcode-amount"},f={class:"amount-value"},h=o((function(){return(0,i._)("img",{src:a,alt:"微信支付二维码",class:"qrcode-image"},null,-1)})),v=o((function(){return(0,i._)("div",{class:"scan-tip"},"请使用微信扫一扫",-1)})),g={class:"compact-countdown"},p=o((function(){return(0,i._)("span",{class:"countdown-label"},"支付倒计时：",-1)})),w={class:"countdown-time"},_={class:"info-item"},T=o((function(){return(0,i._)("div",{class:"label"},"会员信息",-1)})),b={class:"value highlight"},k={class:"info-item"},y=o((function(){return(0,i._)("div",{class:"label"},"订单号",-1)})),I={class:"value"},x={class:"info-item"},P=o((function(){return(0,i._)("div",{class:"label"},"订单状态",-1)})),V={class:"value"},C=o((function(){return(0,i._)("div",{class:"payment-tips"},[(0,i._)("i",{class:"el-icon-info-filled"}),(0,i._)("span",null,"支付小贴士：如遇支付问题，请联系站长哦！")],-1)})),A={class:"success-content"},Z=o((function(){return(0,i._)("i",{class:"el-icon-circle-check success-icon"},null,-1)})),S=o((function(){return(0,i._)("h2",null,"恭喜您成为邻诗会员！",-1)}));function z(n,t,e,a,o,z){var W=(0,i.up)("el-progress"),U=(0,i.up)("el-form"),q=(0,i.up)("el-dialog"),D=(0,i.up)("el-button"),M=(0,i.Q2)("loading");return(0,i.wy)(((0,i.wg)(),(0,i.iD)("div",s,[(0,i.Wm)(q,{width:"420px",class:"payment-dialog",modelValue:o.dialogTableVisible,"onUpdate:modelValue":t[0]||(t[0]=function(n){return o.dialogTableVisible=n}),"close-on-click-modal":!1},{header:(0,i.w5)((function(){return[(0,i._)("div",c,[l,(0,i._)("span",null,"微信支付页 - "+(0,r.zw)(o.activeIndex),1)])]})),default:(0,i.w5)((function(){return[(0,i.Wm)(U,{model:o.form,"label-position":"top",ref:"form"},{default:(0,i.w5)((function(){return[(0,i._)("div",u,[(0,i._)("div",d,[(0,i._)("div",m,[(0,i._)("span",f,"¥"+(0,r.zw)(o.form.amount),1)]),h,v,(0,i._)("div",g,[p,(0,i._)("span",w,(0,r.zw)(z.formatTime(o.remainingTime)),1),(0,i.Wm)(W,{percentage:z.timePercentage,"show-text":!1,"stroke-width":4,status:"warning",class:"mini-progress"},null,8,["percentage"])])]),(0,i._)("div",_,[T,(0,i._)("div",b,(0,r.zw)(o.info),1)]),(0,i._)("div",k,[y,(0,i._)("div",I,(0,r.zw)(o.form.payment_no),1)]),(0,i._)("div",x,[P,(0,i._)("div",V,(0,r.zw)(o.form.status),1)]),C])]})),_:1},8,["model"])]})),_:1},8,["modelValue"]),(0,i.Wm)(q,{width:"420px",class:"success-dialog",modelValue:o.congratulationsVisible,"onUpdate:modelValue":t[1]||(t[1]=function(n){return o.congratulationsVisible=n}),"close-on-click-modal":!1},{default:(0,i.w5)((function(){return[(0,i._)("div",A,[Z,S,(0,i.Wm)(D,{type:"primary",onClick:z.closeCongratulations,class:"close-button"},{default:(0,i.w5)((function(){return[(0,i.Uk)(" 开始体验 ")]})),_:1},8,["onClick"])])]})),_:1},8,["modelValue"])])),[[M,o.loading]])}var W=e(46559),U=e(78955),q=(e(67991),e(85200),e(14632),e(5982),e(56151)),D={name:"OrderPayDialog",data:function(){return{isPaid:!1,isTrans:!1,payUrl:"",dialogTableVisible:!1,congratulationsVisible:!1,form:{amount:0,create_time:"AAA",payment_id:"AAA",payment_no:"AAA",status:"AAA",user_id:0},activeIndex:"",loading:!1,info:"",remainingTime:300,maxTime:300,countdownTimer:null}},computed:{timePercentage:function(){return this.remainingTime/this.maxTime*100}},watch:{dialogTableVisible:function(n){n||(this.loading=!1,this.isPaid=!1,this.isTrans=!1,this.countdownTimer&&(clearInterval(this.countdownTimer),this.countdownTimer=null))}},methods:{show:function(n,t){this.form=n,this.info=t||"VIP · 1年",this.dialogTableVisible=!0,this.activeIndex=this.form.payment_no,this.loading=!1,this.startCheckPay(this.form.payment_id),this.startCountdown()},closeCongratulations:function(){this.congratulationsVisible=!1,this.loading=!1},CheckPay:function(n){var t=this;return(0,U.Z)((0,W.Z)().mark((function e(){var i;return(0,W.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,q.Z.postOrderNoPayCheck2(n);case 3:i=e.sent,"支付成功"===i&&(t.form.status=i,t.dialogTableVisible=!1,t.congratulationsVisible=!0,clearInterval(t.checkPayInterval),t.countdownTimer&&(clearInterval(t.countdownTimer),t.countdownTimer=null),t.$message.success("恭喜您成为邻诗会员！")),e.next=10;break;case 7:e.prev=7,e.t0=e["catch"](0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))()},startCheckPay:function(n){var t=this,e=3e5,i=0;this.checkPayInterval=setInterval((0,U.Z)((0,W.Z)().mark((function r(){return(0,W.Z)().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,t.CheckPay(n);case 2:i+=5e3,i>=e&&(clearInterval(t.checkPayInterval),console.log("Payment check timeout."),t.form.status="支付失败",t.countdownTimer&&(clearInterval(t.countdownTimer),t.countdownTimer=null));case 4:case"end":return r.stop()}}),r)}))),5e3)},formatTime:function(n){var t=Math.floor(n/60),e=n%60;return"".concat(t.toString().padStart(2,"0"),":").concat(e.toString().padStart(2,"0"))},startCountdown:function(){var n=this;this.remainingTime=this.maxTime,this.countdownTimer&&clearInterval(this.countdownTimer),this.countdownTimer=setInterval((function(){n.remainingTime>0?n.remainingTime-=1:(clearInterval(n.countdownTimer),n.countdownTimer=null)}),1e3)}},beforeUnmount:function(){this.checkPayInterval&&clearInterval(this.checkPayInterval),this.countdownTimer&&clearInterval(this.countdownTimer)}},M=e(64186);const O=(0,M.Z)(D,[["render",z],["__scopeId","data-v-672539b3"]]);var R=O},3757:function(n,t,e){"use strict";n.exports=e.p+"img/wxpay.29ad377b.png"}}]);
//# sourceMappingURL=8-legacy.da0e86aa.js.map