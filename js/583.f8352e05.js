"use strict";(self["webpackChunklin_cms_vvlog"]=self["webpackChunklin_cms_vvlog"]||[]).push([[583],{59583:function(e,t,s){s.r(t),s.d(t,{default:function(){return Ye}});var n=s(6808),i=s(59511),r=s(41441);const l=e=>((0,n.dD)("data-v-9eb633d4"),e=e(),(0,n.Cn)(),e),a={class:"chat-dialog"},o=l((()=>(0,n._)("div",{class:"chat-header"},[(0,n._)("div",{class:"header-title"},[(0,n._)("i",{class:"el-icon-chat-dot-round"}),(0,n._)("span",null,"遥遥领先的测算大模型！")])],-1))),c={class:"chat-body",ref:"chatBody"},h={class:"message-list"},u={class:"message-avatar"},p={class:"message-wrapper"},g=["innerHTML"],d={key:0,class:"loading-indicator"},k=l((()=>(0,n._)("i",{class:"el-icon-loading"},null,-1))),f={class:"chat-footer"},m={class:"input-wrapper"},b=["disabled"],x=l((()=>(0,n._)("i",{class:"el-icon-s-promotion"},null,-1))),w=[x],y=l((()=>(0,n._)("i",{class:"el-icon-document"},null,-1))),T=[y],_={class:"dialog-footer"};function $(e,t,s,l,x,y){const $=(0,n.up)("el-input"),R=(0,n.up)("el-button"),v=(0,n.up)("el-dialog");return(0,n.wg)(),(0,n.iD)("div",a,[o,(0,n._)("div",c,[(0,n._)("ul",h,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(x.messages,((e,t)=>((0,n.wg)(),(0,n.iD)("li",{key:t,class:(0,i.C_)(["message-item","user"===e.role?"user-message":"system-message"])},[(0,n._)("div",u,[(0,n._)("i",{class:(0,i.C_)("user"===e.role?"el-icon-user":"el-icon-chat-dot-round")},null,2)]),(0,n._)("div",p,[(0,n._)("div",{class:"message-content",innerHTML:y.parseMarkdown(e.content)},null,8,g)])],2)))),128))]),x.isLoading?((0,n.wg)(),(0,n.iD)("div",d,[(0,n.Uk)(" 邻诗正在深度思考中...."),k])):(0,n.kq)("",!0)],512),(0,n._)("div",f,[(0,n._)("div",m,[(0,n.wy)((0,n._)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>x.inputMessage=e),placeholder:"输入您的问题...",onKeyup:t[1]||(t[1]=(0,r.D2)(((...e)=>y.sendMessage&&y.sendMessage(...e)),["enter"])),ref:"inputField"},null,544),[[r.nr,x.inputMessage]]),(0,n._)("button",{class:"send-button",onClick:t[2]||(t[2]=(...e)=>y.sendMessage&&y.sendMessage(...e)),disabled:!x.inputMessage.trim()},w,8,b),y.loggedIn&&-1===x.ai_chat_count?((0,n.wg)(),(0,n.iD)("button",{key:0,class:"publish-button",onClick:t[3]||(t[3]=(...e)=>y.showPublishDialog&&y.showPublishDialog(...e))},T)):(0,n.kq)("",!0)])]),(0,n.Wm)(v,{title:"发布对话",modelValue:x.publishDialogVisible,"onUpdate:modelValue":t[6]||(t[6]=e=>x.publishDialogVisible=e),width:"30%"},{footer:(0,n.w5)((()=>[(0,n._)("span",_,[(0,n.Wm)(R,{onClick:t[5]||(t[5]=e=>x.publishDialogVisible=!1)},{default:(0,n.w5)((()=>[(0,n.Uk)("取消")])),_:1}),(0,n.Wm)(R,{type:"primary",onClick:y.publishChat},{default:(0,n.w5)((()=>[(0,n.Uk)("确认")])),_:1},8,["onClick"])])])),default:(0,n.w5)((()=>[(0,n.Wm)($,{modelValue:x.dialogTitle,"onUpdate:modelValue":t[4]||(t[4]=e=>x.dialogTitle=e),placeholder:"请输入标题"},null,8,["modelValue"])])),_:1},8,["modelValue"])])}s(87477);var R=s(18807),v=s(78307),S=s(10299),z=s.n(S);function A(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}let I=A();function P(e){I=e}const C={exec:()=>null};function L(e,t=""){let s="string"===typeof e?e:e.source;const n={replace:(e,t)=>{let i="string"===typeof t?t:t.source;return i=i.replace(B.caret,"$1"),s=s.replace(e,i),n},getRegex:()=>new RegExp(s,t)};return n}const B={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] /,listReplaceTask:/^\[[ xX]\] +/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/gi,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:e=>new RegExp(`^( {0,3}${e})((?:[\t ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ \t][^\\n]*)?(?:\\n|$))`),hrRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}#`),htmlBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}<(?:[a-z].*>|!--)`,"i")},q=/^(?:[ \t]*(?:\n|$))+/,D=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,E=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,M=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,V=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,Z=/(?:[*+-]|\d{1,9}[.)])/,U=L(/^(?!bull |blockCode|fences|blockquote|heading|html)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html))+?)\n {0,3}(=+|-+) *(?:\n+|$)/).replace(/bull/g,Z).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).getRegex(),W=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,O=/^[^\n]+/,N=/(?!\s*\])(?:\\.|[^\[\]\\])+/,H=L(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",N).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),Q=L(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,Z).getRegex(),j="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",G=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,F=L("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ \t]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ \t]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ \t]*)+\\n|$))","i").replace("comment",G).replace("tag",j).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),X=L(W).replace("hr",M).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",j).getRegex(),K=L(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",X).getRegex(),Y={blockquote:K,code:D,def:H,fences:E,heading:V,hr:M,html:F,lheading:U,list:Q,newline:q,paragraph:X,table:C,text:O},J=L("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",M).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}\t)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",j).getRegex(),ee={...Y,table:J,paragraph:L(W).replace("hr",M).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",J).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",j).getRegex()},te={...Y,html:L("^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:\"[^\"]*\"|'[^']*'|\\s[^'\"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))").replace("comment",G).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:C,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:L(W).replace("hr",M).replace("heading"," *#{1,6} *[^\n]").replace("lheading",U).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},se=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,ne=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,ie=/^( {2,}|\\)\n(?!\s*$)/,re=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,le=/[\p{P}\p{S}]/u,ae=/[\s\p{P}\p{S}]/u,oe=/[^\s\p{P}\p{S}]/u,ce=L(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,ae).getRegex(),he=/\[[^[\]]*?\]\((?:\\.|[^\\\(\)]|\((?:\\.|[^\\\(\)])*\))*\)|`[^`]*?`|<[^<>]*?>/g,ue=L(/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,"u").replace(/punct/g,le).getRegex(),pe=L("^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)","gu").replace(/notPunctSpace/g,oe).replace(/punctSpace/g,ae).replace(/punct/g,le).getRegex(),ge=L("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,oe).replace(/punctSpace/g,ae).replace(/punct/g,le).getRegex(),de=L(/\\(punct)/,"gu").replace(/punct/g,le).getRegex(),ke=L(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),fe=L(G).replace("(?:--\x3e|$)","--\x3e").getRegex(),me=L("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",fe).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),be=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,xe=L(/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/).replace("label",be).replace("href",/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),we=L(/^!?\[(label)\]\[(ref)\]/).replace("label",be).replace("ref",N).getRegex(),ye=L(/^!?\[(ref)\](?:\[\])?/).replace("ref",N).getRegex(),Te=L("reflink|nolink(?!\\()","g").replace("reflink",we).replace("nolink",ye).getRegex(),_e={_backpedal:C,anyPunctuation:de,autolink:ke,blockSkip:he,br:ie,code:ne,del:C,emStrongLDelim:ue,emStrongRDelimAst:pe,emStrongRDelimUnd:ge,escape:se,link:xe,nolink:ye,punctuation:ce,reflink:we,reflinkSearch:Te,tag:me,text:re,url:C},$e={..._e,link:L(/^!?\[(label)\]\((.*?)\)/).replace("label",be).getRegex(),reflink:L(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",be).getRegex()},Re={..._e,escape:L(se).replace("])","~|])").getRegex(),url:L(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\.|[^\\])*?(?:\\.|[^\s~\\]))\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},ve={...Re,br:L(ie).replace("{2,}","*").getRegex(),text:L(Re.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},Se={normal:Y,gfm:ee,pedantic:te},ze={normal:_e,gfm:Re,breaks:ve,pedantic:$e},Ae={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Ie=e=>Ae[e];function Pe(e,t){if(t){if(B.escapeTest.test(e))return e.replace(B.escapeReplace,Ie)}else if(B.escapeTestNoEncode.test(e))return e.replace(B.escapeReplaceNoEncode,Ie);return e}function Ce(e){try{e=encodeURI(e).replace(B.percentDecode,"%")}catch{return null}return e}function Le(e,t){const s=e.replace(B.findPipe,((e,t,s)=>{let n=!1,i=t;while(--i>=0&&"\\"===s[i])n=!n;return n?"|":" |"})),n=s.split(B.splitPipe);let i=0;if(n[0].trim()||n.shift(),n.length>0&&!n.at(-1)?.trim()&&n.pop(),t)if(n.length>t)n.splice(t);else while(n.length<t)n.push("");for(;i<n.length;i++)n[i]=n[i].trim().replace(B.slashPipe,"|");return n}function Be(e,t,s){const n=e.length;if(0===n)return"";let i=0;while(i<n){const r=e.charAt(n-i-1);if(r!==t||s){if(r===t||!s)break;i++}else i++}return e.slice(0,n-i)}function qe(e,t){if(-1===e.indexOf(t[1]))return-1;let s=0;for(let n=0;n<e.length;n++)if("\\"===e[n])n++;else if(e[n]===t[0])s++;else if(e[n]===t[1]&&(s--,s<0))return n;return-1}function De(e,t,s,n,i){const r=t.href,l=t.title||null,a=e[1].replace(i.other.outputLinkReplace,"$1");if("!"!==e[0].charAt(0)){n.state.inLink=!0;const e={type:"link",raw:s,href:r,title:l,text:a,tokens:n.inlineTokens(a)};return n.state.inLink=!1,e}return{type:"image",raw:s,href:r,title:l,text:a}}function Ee(e,t,s){const n=e.match(s.other.indentCodeCompensation);if(null===n)return t;const i=n[1];return t.split("\n").map((e=>{const t=e.match(s.other.beginningSpace);if(null===t)return e;const[n]=t;return n.length>=i.length?e.slice(i.length):e})).join("\n")}class Me{options;rules;lexer;constructor(e){this.options=e||I}space(e){const t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){const t=this.rules.block.code.exec(e);if(t){const e=t[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?e:Be(e,"\n")}}}fences(e){const t=this.rules.block.fences.exec(e);if(t){const e=t[0],s=Ee(e,t[3]||"",this.rules);return{type:"code",raw:e,lang:t[2]?t[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):t[2],text:s}}}heading(e){const t=this.rules.block.heading.exec(e);if(t){let e=t[2].trim();if(this.rules.other.endingHash.test(e)){const t=Be(e,"#");this.options.pedantic?e=t.trim():t&&!this.rules.other.endingSpaceChar.test(t)||(e=t.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:e,tokens:this.lexer.inline(e)}}}hr(e){const t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:Be(t[0],"\n")}}blockquote(e){const t=this.rules.block.blockquote.exec(e);if(t){let e=Be(t[0],"\n").split("\n"),s="",n="";const i=[];while(e.length>0){let t=!1;const r=[];let l;for(l=0;l<e.length;l++)if(this.rules.other.blockquoteStart.test(e[l]))r.push(e[l]),t=!0;else{if(t)break;r.push(e[l])}e=e.slice(l);const a=r.join("\n"),o=a.replace(this.rules.other.blockquoteSetextReplace,"\n    $1").replace(this.rules.other.blockquoteSetextReplace2,"");s=s?`${s}\n${a}`:a,n=n?`${n}\n${o}`:o;const c=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(o,i,!0),this.lexer.state.top=c,0===e.length)break;const h=i.at(-1);if("code"===h?.type)break;if("blockquote"===h?.type){const t=h,r=t.raw+"\n"+e.join("\n"),l=this.blockquote(r);i[i.length-1]=l,s=s.substring(0,s.length-t.raw.length)+l.raw,n=n.substring(0,n.length-t.text.length)+l.text;break}if("list"!==h?.type);else{const t=h,r=t.raw+"\n"+e.join("\n"),l=this.list(r);i[i.length-1]=l,s=s.substring(0,s.length-h.raw.length)+l.raw,n=n.substring(0,n.length-t.raw.length)+l.raw,e=r.substring(i.at(-1).raw.length).split("\n")}}return{type:"blockquote",raw:s,tokens:i,text:n}}}list(e){let t=this.rules.block.list.exec(e);if(t){let s=t[1].trim();const n=s.length>1,i={type:"list",raw:"",ordered:n,start:n?+s.slice(0,-1):"",loose:!1,items:[]};s=n?`\\d{1,9}\\${s.slice(-1)}`:`\\${s}`,this.options.pedantic&&(s=n?s:"[*+-]");const r=this.rules.other.listItemRegex(s);let l=!1;while(e){let s=!1,n="",a="";if(!(t=r.exec(e)))break;if(this.rules.block.hr.test(e))break;n=t[0],e=e.substring(n.length);let o=t[2].split("\n",1)[0].replace(this.rules.other.listReplaceTabs,(e=>" ".repeat(3*e.length))),c=e.split("\n",1)[0],h=!o.trim(),u=0;if(this.options.pedantic?(u=2,a=o.trimStart()):h?u=t[1].length+1:(u=t[2].search(this.rules.other.nonSpaceChar),u=u>4?1:u,a=o.slice(u),u+=t[1].length),h&&this.rules.other.blankLine.test(c)&&(n+=c+"\n",e=e.substring(c.length+1),s=!0),!s){const t=this.rules.other.nextBulletRegex(u),s=this.rules.other.hrRegex(u),i=this.rules.other.fencesBeginRegex(u),r=this.rules.other.headingBeginRegex(u),l=this.rules.other.htmlBeginRegex(u);while(e){const p=e.split("\n",1)[0];let g;if(c=p,this.options.pedantic?(c=c.replace(this.rules.other.listReplaceNesting,"  "),g=c):g=c.replace(this.rules.other.tabCharGlobal,"    "),i.test(c))break;if(r.test(c))break;if(l.test(c))break;if(t.test(c))break;if(s.test(c))break;if(g.search(this.rules.other.nonSpaceChar)>=u||!c.trim())a+="\n"+g.slice(u);else{if(h)break;if(o.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4)break;if(i.test(o))break;if(r.test(o))break;if(s.test(o))break;a+="\n"+c}h||c.trim()||(h=!0),n+=p+"\n",e=e.substring(p.length+1),o=g.slice(u)}}i.loose||(l?i.loose=!0:this.rules.other.doubleBlankLine.test(n)&&(l=!0));let p,g=null;this.options.gfm&&(g=this.rules.other.listIsTask.exec(a),g&&(p="[ ] "!==g[0],a=a.replace(this.rules.other.listReplaceTask,""))),i.items.push({type:"list_item",raw:n,task:!!g,checked:p,loose:!1,text:a,tokens:[]}),i.raw+=n}const a=i.items.at(-1);if(!a)return;a.raw=a.raw.trimEnd(),a.text=a.text.trimEnd(),i.raw=i.raw.trimEnd();for(let e=0;e<i.items.length;e++)if(this.lexer.state.top=!1,i.items[e].tokens=this.lexer.blockTokens(i.items[e].text,[]),!i.loose){const t=i.items[e].tokens.filter((e=>"space"===e.type)),s=t.length>0&&t.some((e=>this.rules.other.anyLine.test(e.raw)));i.loose=s}if(i.loose)for(let e=0;e<i.items.length;e++)i.items[e].loose=!0;return i}}html(e){const t=this.rules.block.html.exec(e);if(t){const e={type:"html",block:!0,raw:t[0],pre:"pre"===t[1]||"script"===t[1]||"style"===t[1],text:t[0]};return e}}def(e){const t=this.rules.block.def.exec(e);if(t){const e=t[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),s=t[2]?t[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",n=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):t[3];return{type:"def",tag:e,raw:t[0],href:s,title:n}}}table(e){const t=this.rules.block.table.exec(e);if(!t)return;if(!this.rules.other.tableDelimiter.test(t[2]))return;const s=Le(t[1]),n=t[2].replace(this.rules.other.tableAlignChars,"").split("|"),i=t[3]?.trim()?t[3].replace(this.rules.other.tableRowBlankLine,"").split("\n"):[],r={type:"table",raw:t[0],header:[],align:[],rows:[]};if(s.length===n.length){for(const e of n)this.rules.other.tableAlignRight.test(e)?r.align.push("right"):this.rules.other.tableAlignCenter.test(e)?r.align.push("center"):this.rules.other.tableAlignLeft.test(e)?r.align.push("left"):r.align.push(null);for(let e=0;e<s.length;e++)r.header.push({text:s[e],tokens:this.lexer.inline(s[e]),header:!0,align:r.align[e]});for(const e of i)r.rows.push(Le(e,r.header.length).map(((e,t)=>({text:e,tokens:this.lexer.inline(e),header:!1,align:r.align[t]}))));return r}}lheading(e){const t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:"="===t[2].charAt(0)?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(e){const t=this.rules.block.paragraph.exec(e);if(t){const e="\n"===t[1].charAt(t[1].length-1)?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:e,tokens:this.lexer.inline(e)}}}text(e){const t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(e){const t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:t[1]}}tag(e){const t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&this.rules.other.startATag.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:t[0]}}link(e){const t=this.rules.inline.link.exec(e);if(t){const e=t[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(e)){if(!this.rules.other.endAngleBracket.test(e))return;const t=Be(e.slice(0,-1),"\\");if((e.length-t.length)%2===0)return}else{const e=qe(t[2],"()");if(e>-1){const s=0===t[0].indexOf("!")?5:4,n=s+t[1].length+e;t[2]=t[2].substring(0,e),t[0]=t[0].substring(0,n).trim(),t[3]=""}}let s=t[2],n="";if(this.options.pedantic){const e=this.rules.other.pedanticHrefTitle.exec(s);e&&(s=e[1],n=e[3])}else n=t[3]?t[3].slice(1,-1):"";return s=s.trim(),this.rules.other.startAngleBracket.test(s)&&(s=this.options.pedantic&&!this.rules.other.endAngleBracket.test(e)?s.slice(1):s.slice(1,-1)),De(t,{href:s?s.replace(this.rules.inline.anyPunctuation,"$1"):s,title:n?n.replace(this.rules.inline.anyPunctuation,"$1"):n},t[0],this.lexer,this.rules)}}reflink(e,t){let s;if((s=this.rules.inline.reflink.exec(e))||(s=this.rules.inline.nolink.exec(e))){const e=(s[2]||s[1]).replace(this.rules.other.multipleSpaceGlobal," "),n=t[e.toLowerCase()];if(!n){const e=s[0].charAt(0);return{type:"text",raw:e,text:e}}return De(s,n,s[0],this.lexer,this.rules)}}emStrong(e,t,s=""){let n=this.rules.inline.emStrongLDelim.exec(e);if(!n)return;if(n[3]&&s.match(this.rules.other.unicodeAlphaNumeric))return;const i=n[1]||n[2]||"";if(!i||!s||this.rules.inline.punctuation.exec(s)){const s=[...n[0]].length-1;let i,r,l=s,a=0;const o="*"===n[0][0]?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;o.lastIndex=0,t=t.slice(-1*e.length+s);while(null!=(n=o.exec(t))){if(i=n[1]||n[2]||n[3]||n[4]||n[5]||n[6],!i)continue;if(r=[...i].length,n[3]||n[4]){l+=r;continue}if((n[5]||n[6])&&s%3&&!((s+r)%3)){a+=r;continue}if(l-=r,l>0)continue;r=Math.min(r,r+l+a);const t=[...n[0]][0].length,o=e.slice(0,s+n.index+t+r);if(Math.min(s,r)%2){const e=o.slice(1,-1);return{type:"em",raw:o,text:e,tokens:this.lexer.inlineTokens(e)}}const c=o.slice(2,-2);return{type:"strong",raw:o,text:c,tokens:this.lexer.inlineTokens(c)}}}}codespan(e){const t=this.rules.inline.code.exec(e);if(t){let e=t[2].replace(this.rules.other.newLineCharGlobal," ");const s=this.rules.other.nonSpaceChar.test(e),n=this.rules.other.startingSpaceChar.test(e)&&this.rules.other.endingSpaceChar.test(e);return s&&n&&(e=e.substring(1,e.length-1)),{type:"codespan",raw:t[0],text:e}}}br(e){const t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){const t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(e){const t=this.rules.inline.autolink.exec(e);if(t){let e,s;return"@"===t[2]?(e=t[1],s="mailto:"+e):(e=t[1],s=e),{type:"link",raw:t[0],text:e,href:s,tokens:[{type:"text",raw:e,text:e}]}}}url(e){let t;if(t=this.rules.inline.url.exec(e)){let e,s;if("@"===t[2])e=t[0],s="mailto:"+e;else{let n;do{n=t[0],t[0]=this.rules.inline._backpedal.exec(t[0])?.[0]??""}while(n!==t[0]);e=t[0],s="www."===t[1]?"http://"+t[0]:t[0]}return{type:"link",raw:t[0],text:e,href:s,tokens:[{type:"text",raw:e,text:e}]}}}inlineText(e){const t=this.rules.inline.text.exec(e);if(t){const e=this.lexer.state.inRawBlock;return{type:"text",raw:t[0],text:t[0],escaped:e}}}}class Ve{tokens;options;state;tokenizer;inlineQueue;constructor(e){this.tokens=[],this.tokens.links=Object.create(null),this.options=e||I,this.options.tokenizer=this.options.tokenizer||new Me,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const t={other:B,block:Se.normal,inline:ze.normal};this.options.pedantic?(t.block=Se.pedantic,t.inline=ze.pedantic):this.options.gfm&&(t.block=Se.gfm,this.options.breaks?t.inline=ze.breaks:t.inline=ze.gfm),this.tokenizer.rules=t}static get rules(){return{block:Se,inline:ze}}static lex(e,t){const s=new Ve(t);return s.lex(e)}static lexInline(e,t){const s=new Ve(t);return s.inlineTokens(e)}lex(e){e=e.replace(B.carriageReturn,"\n"),this.blockTokens(e,this.tokens);for(let t=0;t<this.inlineQueue.length;t++){const e=this.inlineQueue[t];this.inlineTokens(e.src,e.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,t=[],s=!1){this.options.pedantic&&(e=e.replace(B.tabCharGlobal,"    ").replace(B.spaceLine,""));while(e){let n;if(this.options.extensions?.block?.some((s=>!!(n=s.call({lexer:this},e,t))&&(e=e.substring(n.raw.length),t.push(n),!0))))continue;if(n=this.tokenizer.space(e)){e=e.substring(n.raw.length);const s=t.at(-1);1===n.raw.length&&void 0!==s?s.raw+="\n":t.push(n);continue}if(n=this.tokenizer.code(e)){e=e.substring(n.raw.length);const s=t.at(-1);"paragraph"===s?.type||"text"===s?.type?(s.raw+="\n"+n.raw,s.text+="\n"+n.text,this.inlineQueue.at(-1).src=s.text):t.push(n);continue}if(n=this.tokenizer.fences(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.heading(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.hr(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.blockquote(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.list(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.html(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.def(e)){e=e.substring(n.raw.length);const s=t.at(-1);"paragraph"===s?.type||"text"===s?.type?(s.raw+="\n"+n.raw,s.text+="\n"+n.raw,this.inlineQueue.at(-1).src=s.text):this.tokens.links[n.tag]||(this.tokens.links[n.tag]={href:n.href,title:n.title});continue}if(n=this.tokenizer.table(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.lheading(e)){e=e.substring(n.raw.length),t.push(n);continue}let i=e;if(this.options.extensions?.startBlock){let t=1/0;const s=e.slice(1);let n;this.options.extensions.startBlock.forEach((e=>{n=e.call({lexer:this},s),"number"===typeof n&&n>=0&&(t=Math.min(t,n))})),t<1/0&&t>=0&&(i=e.substring(0,t+1))}if(this.state.top&&(n=this.tokenizer.paragraph(i))){const r=t.at(-1);s&&"paragraph"===r?.type?(r.raw+="\n"+n.raw,r.text+="\n"+n.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=r.text):t.push(n),s=i.length!==e.length,e=e.substring(n.raw.length)}else if(n=this.tokenizer.text(e)){e=e.substring(n.raw.length);const s=t.at(-1);"text"===s?.type?(s.raw+="\n"+n.raw,s.text+="\n"+n.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=s.text):t.push(n)}else if(e){const t="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(t);break}throw new Error(t)}}return this.state.top=!0,t}inline(e,t=[]){return this.inlineQueue.push({src:e,tokens:t}),t}inlineTokens(e,t=[]){let s=e,n=null;if(this.tokens.links){const e=Object.keys(this.tokens.links);if(e.length>0)while(null!=(n=this.tokenizer.rules.inline.reflinkSearch.exec(s)))e.includes(n[0].slice(n[0].lastIndexOf("[")+1,-1))&&(s=s.slice(0,n.index)+"["+"a".repeat(n[0].length-2)+"]"+s.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}while(null!=(n=this.tokenizer.rules.inline.blockSkip.exec(s)))s=s.slice(0,n.index)+"["+"a".repeat(n[0].length-2)+"]"+s.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);while(null!=(n=this.tokenizer.rules.inline.anyPunctuation.exec(s)))s=s.slice(0,n.index)+"++"+s.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);let i=!1,r="";while(e){let n;if(i||(r=""),i=!1,this.options.extensions?.inline?.some((s=>!!(n=s.call({lexer:this},e,t))&&(e=e.substring(n.raw.length),t.push(n),!0))))continue;if(n=this.tokenizer.escape(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.tag(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.link(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(n.raw.length);const s=t.at(-1);"text"===n.type&&"text"===s?.type?(s.raw+=n.raw,s.text+=n.text):t.push(n);continue}if(n=this.tokenizer.emStrong(e,s,r)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.codespan(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.br(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.del(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.autolink(e)){e=e.substring(n.raw.length),t.push(n);continue}if(!this.state.inLink&&(n=this.tokenizer.url(e))){e=e.substring(n.raw.length),t.push(n);continue}let l=e;if(this.options.extensions?.startInline){let t=1/0;const s=e.slice(1);let n;this.options.extensions.startInline.forEach((e=>{n=e.call({lexer:this},s),"number"===typeof n&&n>=0&&(t=Math.min(t,n))})),t<1/0&&t>=0&&(l=e.substring(0,t+1))}if(n=this.tokenizer.inlineText(l)){e=e.substring(n.raw.length),"_"!==n.raw.slice(-1)&&(r=n.raw.slice(-1)),i=!0;const s=t.at(-1);"text"===s?.type?(s.raw+=n.raw,s.text+=n.text):t.push(n)}else if(e){const t="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(t);break}throw new Error(t)}}return t}}class Ze{options;parser;constructor(e){this.options=e||I}space(e){return""}code({text:e,lang:t,escaped:s}){const n=(t||"").match(B.notSpaceStart)?.[0],i=e.replace(B.endingNewline,"")+"\n";return n?'<pre><code class="language-'+Pe(n)+'">'+(s?i:Pe(i,!0))+"</code></pre>\n":"<pre><code>"+(s?i:Pe(i,!0))+"</code></pre>\n"}blockquote({tokens:e}){const t=this.parser.parse(e);return`<blockquote>\n${t}</blockquote>\n`}html({text:e}){return e}heading({tokens:e,depth:t}){return`<h${t}>${this.parser.parseInline(e)}</h${t}>\n`}hr(e){return"<hr>\n"}list(e){const t=e.ordered,s=e.start;let n="";for(let l=0;l<e.items.length;l++){const t=e.items[l];n+=this.listitem(t)}const i=t?"ol":"ul",r=t&&1!==s?' start="'+s+'"':"";return"<"+i+r+">\n"+n+"</"+i+">\n"}listitem(e){let t="";if(e.task){const s=this.checkbox({checked:!!e.checked});e.loose?"paragraph"===e.tokens[0]?.type?(e.tokens[0].text=s+" "+e.tokens[0].text,e.tokens[0].tokens&&e.tokens[0].tokens.length>0&&"text"===e.tokens[0].tokens[0].type&&(e.tokens[0].tokens[0].text=s+" "+Pe(e.tokens[0].tokens[0].text),e.tokens[0].tokens[0].escaped=!0)):e.tokens.unshift({type:"text",raw:s+" ",text:s+" ",escaped:!0}):t+=s+" "}return t+=this.parser.parse(e.tokens,!!e.loose),`<li>${t}</li>\n`}checkbox({checked:e}){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:e}){return`<p>${this.parser.parseInline(e)}</p>\n`}table(e){let t="",s="";for(let i=0;i<e.header.length;i++)s+=this.tablecell(e.header[i]);t+=this.tablerow({text:s});let n="";for(let i=0;i<e.rows.length;i++){const t=e.rows[i];s="";for(let e=0;e<t.length;e++)s+=this.tablecell(t[e]);n+=this.tablerow({text:s})}return n&&(n=`<tbody>${n}</tbody>`),"<table>\n<thead>\n"+t+"</thead>\n"+n+"</table>\n"}tablerow({text:e}){return`<tr>\n${e}</tr>\n`}tablecell(e){const t=this.parser.parseInline(e.tokens),s=e.header?"th":"td",n=e.align?`<${s} align="${e.align}">`:`<${s}>`;return n+t+`</${s}>\n`}strong({tokens:e}){return`<strong>${this.parser.parseInline(e)}</strong>`}em({tokens:e}){return`<em>${this.parser.parseInline(e)}</em>`}codespan({text:e}){return`<code>${Pe(e,!0)}</code>`}br(e){return"<br>"}del({tokens:e}){return`<del>${this.parser.parseInline(e)}</del>`}link({href:e,title:t,tokens:s}){const n=this.parser.parseInline(s),i=Ce(e);if(null===i)return n;e=i;let r='<a href="'+e+'"';return t&&(r+=' title="'+Pe(t)+'"'),r+=">"+n+"</a>",r}image({href:e,title:t,text:s}){const n=Ce(e);if(null===n)return Pe(s);e=n;let i=`<img src="${e}" alt="${s}"`;return t&&(i+=` title="${Pe(t)}"`),i+=">",i}text(e){return"tokens"in e&&e.tokens?this.parser.parseInline(e.tokens):"escaped"in e&&e.escaped?e.text:Pe(e.text)}}class Ue{strong({text:e}){return e}em({text:e}){return e}codespan({text:e}){return e}del({text:e}){return e}html({text:e}){return e}text({text:e}){return e}link({text:e}){return""+e}image({text:e}){return""+e}br(){return""}}class We{options;renderer;textRenderer;constructor(e){this.options=e||I,this.options.renderer=this.options.renderer||new Ze,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new Ue}static parse(e,t){const s=new We(t);return s.parse(e)}static parseInline(e,t){const s=new We(t);return s.parseInline(e)}parse(e,t=!0){let s="";for(let n=0;n<e.length;n++){const i=e[n];if(this.options.extensions?.renderers?.[i.type]){const e=i,t=this.options.extensions.renderers[e.type].call({parser:this},e);if(!1!==t||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(e.type)){s+=t||"";continue}}const r=i;switch(r.type){case"space":s+=this.renderer.space(r);continue;case"hr":s+=this.renderer.hr(r);continue;case"heading":s+=this.renderer.heading(r);continue;case"code":s+=this.renderer.code(r);continue;case"table":s+=this.renderer.table(r);continue;case"blockquote":s+=this.renderer.blockquote(r);continue;case"list":s+=this.renderer.list(r);continue;case"html":s+=this.renderer.html(r);continue;case"paragraph":s+=this.renderer.paragraph(r);continue;case"text":{let i=r,l=this.renderer.text(i);while(n+1<e.length&&"text"===e[n+1].type)i=e[++n],l+="\n"+this.renderer.text(i);s+=t?this.renderer.paragraph({type:"paragraph",raw:l,text:l,tokens:[{type:"text",raw:l,text:l,escaped:!0}]}):l;continue}default:{const e='Token with "'+r.type+'" type was not found.';if(this.options.silent)return console.error(e),"";throw new Error(e)}}}return s}parseInline(e,t=this.renderer){let s="";for(let n=0;n<e.length;n++){const i=e[n];if(this.options.extensions?.renderers?.[i.type]){const e=this.options.extensions.renderers[i.type].call({parser:this},i);if(!1!==e||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(i.type)){s+=e||"";continue}}const r=i;switch(r.type){case"escape":s+=t.text(r);break;case"html":s+=t.html(r);break;case"link":s+=t.link(r);break;case"image":s+=t.image(r);break;case"strong":s+=t.strong(r);break;case"em":s+=t.em(r);break;case"codespan":s+=t.codespan(r);break;case"br":s+=t.br(r);break;case"del":s+=t.del(r);break;case"text":s+=t.text(r);break;default:{const e='Token with "'+r.type+'" type was not found.';if(this.options.silent)return console.error(e),"";throw new Error(e)}}}return s}}class Oe{options;block;constructor(e){this.options=e||I}static passThroughHooks=new Set(["preprocess","postprocess","processAllTokens"]);preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}provideLexer(){return this.block?Ve.lex:Ve.lexInline}provideParser(){return this.block?We.parse:We.parseInline}}class Ne{defaults=A();options=this.setOptions;parse=this.parseMarkdown(!0);parseInline=this.parseMarkdown(!1);Parser=We;Renderer=Ze;TextRenderer=Ue;Lexer=Ve;Tokenizer=Me;Hooks=Oe;constructor(...e){this.use(...e)}walkTokens(e,t){let s=[];for(const n of e)switch(s=s.concat(t.call(this,n)),n.type){case"table":{const e=n;for(const n of e.header)s=s.concat(this.walkTokens(n.tokens,t));for(const n of e.rows)for(const e of n)s=s.concat(this.walkTokens(e.tokens,t));break}case"list":{const e=n;s=s.concat(this.walkTokens(e.items,t));break}default:{const e=n;this.defaults.extensions?.childTokens?.[e.type]?this.defaults.extensions.childTokens[e.type].forEach((n=>{const i=e[n].flat(1/0);s=s.concat(this.walkTokens(i,t))})):e.tokens&&(s=s.concat(this.walkTokens(e.tokens,t)))}}return s}use(...e){const t=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach((e=>{const s={...e};if(s.async=this.defaults.async||s.async||!1,e.extensions&&(e.extensions.forEach((e=>{if(!e.name)throw new Error("extension name required");if("renderer"in e){const s=t.renderers[e.name];t.renderers[e.name]=s?function(...t){let n=e.renderer.apply(this,t);return!1===n&&(n=s.apply(this,t)),n}:e.renderer}if("tokenizer"in e){if(!e.level||"block"!==e.level&&"inline"!==e.level)throw new Error("extension level must be 'block' or 'inline'");const s=t[e.level];s?s.unshift(e.tokenizer):t[e.level]=[e.tokenizer],e.start&&("block"===e.level?t.startBlock?t.startBlock.push(e.start):t.startBlock=[e.start]:"inline"===e.level&&(t.startInline?t.startInline.push(e.start):t.startInline=[e.start]))}"childTokens"in e&&e.childTokens&&(t.childTokens[e.name]=e.childTokens)})),s.extensions=t),e.renderer){const t=this.defaults.renderer||new Ze(this.defaults);for(const s in e.renderer){if(!(s in t))throw new Error(`renderer '${s}' does not exist`);if(["options","parser"].includes(s))continue;const n=s,i=e.renderer[n],r=t[n];t[n]=(...e)=>{let s=i.apply(t,e);return!1===s&&(s=r.apply(t,e)),s||""}}s.renderer=t}if(e.tokenizer){const t=this.defaults.tokenizer||new Me(this.defaults);for(const s in e.tokenizer){if(!(s in t))throw new Error(`tokenizer '${s}' does not exist`);if(["options","rules","lexer"].includes(s))continue;const n=s,i=e.tokenizer[n],r=t[n];t[n]=(...e)=>{let s=i.apply(t,e);return!1===s&&(s=r.apply(t,e)),s}}s.tokenizer=t}if(e.hooks){const t=this.defaults.hooks||new Oe;for(const s in e.hooks){if(!(s in t))throw new Error(`hook '${s}' does not exist`);if(["options","block"].includes(s))continue;const n=s,i=e.hooks[n],r=t[n];Oe.passThroughHooks.has(s)?t[n]=e=>{if(this.defaults.async)return Promise.resolve(i.call(t,e)).then((e=>r.call(t,e)));const s=i.call(t,e);return r.call(t,s)}:t[n]=(...e)=>{let s=i.apply(t,e);return!1===s&&(s=r.apply(t,e)),s}}s.hooks=t}if(e.walkTokens){const t=this.defaults.walkTokens,n=e.walkTokens;s.walkTokens=function(e){let s=[];return s.push(n.call(this,e)),t&&(s=s.concat(t.call(this,e))),s}}this.defaults={...this.defaults,...s}})),this}setOptions(e){return this.defaults={...this.defaults,...e},this}lexer(e,t){return Ve.lex(e,t??this.defaults)}parser(e,t){return We.parse(e,t??this.defaults)}parseMarkdown(e){const t=(t,s)=>{const n={...s},i={...this.defaults,...n},r=this.onError(!!i.silent,!!i.async);if(!0===this.defaults.async&&!1===n.async)return r(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if("undefined"===typeof t||null===t)return r(new Error("marked(): input parameter is undefined or null"));if("string"!==typeof t)return r(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(t)+", string expected"));i.hooks&&(i.hooks.options=i,i.hooks.block=e);const l=i.hooks?i.hooks.provideLexer():e?Ve.lex:Ve.lexInline,a=i.hooks?i.hooks.provideParser():e?We.parse:We.parseInline;if(i.async)return Promise.resolve(i.hooks?i.hooks.preprocess(t):t).then((e=>l(e,i))).then((e=>i.hooks?i.hooks.processAllTokens(e):e)).then((e=>i.walkTokens?Promise.all(this.walkTokens(e,i.walkTokens)).then((()=>e)):e)).then((e=>a(e,i))).then((e=>i.hooks?i.hooks.postprocess(e):e)).catch(r);try{i.hooks&&(t=i.hooks.preprocess(t));let e=l(t,i);i.hooks&&(e=i.hooks.processAllTokens(e)),i.walkTokens&&this.walkTokens(e,i.walkTokens);let s=a(e,i);return i.hooks&&(s=i.hooks.postprocess(s)),s}catch(o){return r(o)}};return t}onError(e,t){return s=>{if(s.message+="\nPlease report this to https://github.com/markedjs/marked.",e){const e="<p>An error occurred:</p><pre>"+Pe(s.message+"",!0)+"</pre>";return t?Promise.resolve(e):e}if(t)return Promise.reject(s);throw s}}}const He=new Ne;function Qe(e,t){return He.parse(e,t)}Qe.options=Qe.setOptions=function(e){return He.setOptions(e),Qe.defaults=He.defaults,P(Qe.defaults),Qe},Qe.getDefaults=A,Qe.defaults=I,Qe.use=function(...e){return He.use(...e),Qe.defaults=He.defaults,P(Qe.defaults),Qe},Qe.walkTokens=function(e,t){return He.walkTokens(e,t)},Qe.parseInline=He.parseInline,Qe.Parser=We,Qe.parser=We.parse,Qe.Renderer=Ze,Qe.TextRenderer=Ue,Qe.Lexer=Ve,Qe.lexer=Ve.lex,Qe.Tokenizer=Me,Qe.Hooks=Oe,Qe.parse=Qe;Qe.options,Qe.setOptions,Qe.use,Qe.walkTokens,Qe.parseInline,We.parse,Ve.lex;var je=s(11490),Ge=s(1235),Fe={components:{OrderPayDialog:je.Z},data(){return{messages:[{role:"system",content:"你好，我是邻智AI测算助手，提供八字合婚,流年运势,宝宝/公司起名,姓名配对,八字精批,塔罗牌占卜等在线测算，我会根据您提供的信息进行详细的计算和分析，有什么需要我的帮助吗？"}],inputMessage:"",wdMessages:{},isLoading:!1,typeWriterTimer:null,publishDialogVisible:!1,dialogTitle:"",ai_chat_count:this.$store.state.user.ai_chat_count?this.$store.state.user.ai_chat_count:null}},methods:{async sendMessage(){if(""===this.inputMessage.trim())return;const e=this.inputMessage;this.inputMessage="",this.messages.push({role:"user",content:e}),this.scrollToBottom(),this.isLoading=!0,await this.getAiResponse(),this.isLoading=!1,this.scrollToBottom()},async showPay(){this.$router.push("/server")},async getAiResponse(){try{const t=(0,v.LP)("access_token"),s=await z().post(R.Z.baseURL+"api/blog/articles/chatstream",this.messages,{headers:{"Content-Type":"application/json; charset=utf-8",Authorization:t},responseType:"text"}),n=s.data.split("\n");let i="";this.messages.push({role:"system",content:""});for(const r of n){if(""===r.trim()||"data: [DONE]"===r)continue;const t=r.startsWith("data: ")?r.substring(6):r;try{const e=JSON.parse(t);if(e.choices&&e.choices[0]&&e.choices[0].delta&&e.choices[0].delta.content){const t=e.choices[0].delta.content;i+=t}}catch(e){console.error("Error parsing line:",r,e)}}this.typeWriterEffect(i)}catch(e){this.messages.push({role:"system",content:"系统繁忙，请输入继续！"}),this.inputMessage="继续"}finally{this.isLoading=!1}},async SendwdMessages(){try{this.wdMessages.title=this.dialogTitle,this.wdMessages.messages=this.messages;const e=(0,v.LP)("access_token"),t=await z().post(R.Z.baseURL+"api/blog/articles/wdarticle",this.wdMessages,{headers:{"Content-Type":"application/json; charset=utf-8",Authorization:e},responseType:"text"});if(!0===t.data)Ge.z8.success("发布成功");else{let e='此功能是主播专属功能，请开通主播卡！<a href="/#/server" style="color: #409EFF; text-decoration: underline;">点此订阅</a>';Ge.z8.warning({message:e,dangerouslyUseHTMLString:!0,duration:6e3})}this.publishDialogVisible=!1}catch(e){this.messages.push({role:"system",content:"系统异常，请联系管理员！"}),Ge.z8.error("发布失败,系统异常")}finally{this.isLoading=!1,this.publishDialogVisible=!1}},typeWriterEffect(e){let t=0;const s=this.messages.slice().reverse().find((e=>"system"===e.role));s&&(this.typeWriterTimer&&clearInterval(this.typeWriterTimer),this.typeWriterTimer=setInterval((()=>{t<e.length?(s.content+=e[t],t++,this.scrollToBottom()):(clearInterval(this.typeWriterTimer),this.scrollToBottom())}),20),this.scrollToBottom())},parseMarkdown(e){return Qe.parse(e)},scrollToBottom(){setTimeout((()=>{const e=this.$refs.chatBody;e.scrollTop=e.scrollHeight}),100)},showPublishDialog(){this.dialogTitle="",this.publishDialogVisible=!0},publishChat(){if(!this.dialogTitle.trim())return void Ge.z8.warning("请输入标题");const e=new Date,t=`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`;this.dialogTitle=this.dialogTitle+" "+t,this.SendwdMessages()}},mounted(){const e=this.$route.query.user_input,t=this.$route.query.data_id;t?s.e(188).then(s.bind(s,18188)).then((({getData:e,removeData:s})=>{const n=e(t);if(n){let e=n;this.messages.push({role:"user",content:e}),this.isLoading=!0,this.getAiResponse(),this.scrollToBottom(),s(t)}else Ge.z8.warning("数据已过期或不存在")})).catch((e=>{console.error("读取数据失败:",e),Ge.z8.error("读取数据失败")})):e&&(this.messages.push({role:"user",content:e}),this.isLoading=!0,this.getAiResponse(),this.scrollToBottom())},computed:{loggedIn(){return this.$store.state.loggedIn}}},Xe=s(64186);const Ke=(0,Xe.Z)(Fe,[["render",$],["__scopeId","data-v-9eb633d4"]]);var Ye=Ke},11490:function(e,t,s){s.d(t,{Z:function(){return E}});var n=s(6808),i=s(59511),r=s(3757);const l=e=>((0,n.dD)("data-v-672539b3"),e=e(),(0,n.Cn)(),e),a={"element-loading-background":"rgba(0, 0, 0, 0.7)"},o={class:"dialog-header"},c=l((()=>(0,n._)("i",{class:"el-icon-shopping-cart-2"},null,-1))),h={class:"order-info"},u={class:"qrcode-wrapper"},p={class:"qrcode-amount"},g={class:"amount-value"},d=l((()=>(0,n._)("img",{src:r,alt:"微信支付二维码",class:"qrcode-image"},null,-1))),k=l((()=>(0,n._)("div",{class:"scan-tip"},"请使用微信扫一扫",-1))),f={class:"compact-countdown"},m=l((()=>(0,n._)("span",{class:"countdown-label"},"支付倒计时：",-1))),b={class:"countdown-time"},x={class:"info-item"},w=l((()=>(0,n._)("div",{class:"label"},"会员信息",-1))),y={class:"value highlight"},T={class:"info-item"},_=l((()=>(0,n._)("div",{class:"label"},"订单号",-1))),$={class:"value"},R={class:"info-item"},v=l((()=>(0,n._)("div",{class:"label"},"订单状态",-1))),S={class:"value"},z=l((()=>(0,n._)("div",{class:"payment-tips"},[(0,n._)("i",{class:"el-icon-info-filled"}),(0,n._)("span",null,"支付小贴士：如遇支付问题，请联系站长哦！")],-1))),A={class:"success-content"},I=l((()=>(0,n._)("i",{class:"el-icon-circle-check success-icon"},null,-1))),P=l((()=>(0,n._)("h2",null,"恭喜您成为邻诗会员！",-1)));function C(e,t,s,r,l,C){const L=(0,n.up)("el-progress"),B=(0,n.up)("el-form"),q=(0,n.up)("el-dialog"),D=(0,n.up)("el-button"),E=(0,n.Q2)("loading");return(0,n.wy)(((0,n.wg)(),(0,n.iD)("div",a,[(0,n.Wm)(q,{width:"420px",class:"payment-dialog",modelValue:l.dialogTableVisible,"onUpdate:modelValue":t[0]||(t[0]=e=>l.dialogTableVisible=e),"close-on-click-modal":!1},{header:(0,n.w5)((()=>[(0,n._)("div",o,[c,(0,n._)("span",null,"微信支付页 - "+(0,i.zw)(l.activeIndex),1)])])),default:(0,n.w5)((()=>[(0,n.Wm)(B,{model:l.form,"label-position":"top",ref:"form"},{default:(0,n.w5)((()=>[(0,n._)("div",h,[(0,n._)("div",u,[(0,n._)("div",p,[(0,n._)("span",g,"¥"+(0,i.zw)(l.form.amount),1)]),d,k,(0,n._)("div",f,[m,(0,n._)("span",b,(0,i.zw)(C.formatTime(l.remainingTime)),1),(0,n.Wm)(L,{percentage:C.timePercentage,"show-text":!1,"stroke-width":4,status:"warning",class:"mini-progress"},null,8,["percentage"])])]),(0,n._)("div",x,[w,(0,n._)("div",y,(0,i.zw)(l.info),1)]),(0,n._)("div",T,[_,(0,n._)("div",$,(0,i.zw)(l.form.payment_no),1)]),(0,n._)("div",R,[v,(0,n._)("div",S,(0,i.zw)(l.form.status),1)]),z])])),_:1},8,["model"])])),_:1},8,["modelValue"]),(0,n.Wm)(q,{width:"420px",class:"success-dialog",modelValue:l.congratulationsVisible,"onUpdate:modelValue":t[1]||(t[1]=e=>l.congratulationsVisible=e),"close-on-click-modal":!1},{default:(0,n.w5)((()=>[(0,n._)("div",A,[I,P,(0,n.Wm)(D,{type:"primary",onClick:C.closeCongratulations,class:"close-button"},{default:(0,n.w5)((()=>[(0,n.Uk)(" 开始体验 ")])),_:1},8,["onClick"])])])),_:1},8,["modelValue"])])),[[E,l.loading]])}var L=s(56151),B={name:"OrderPayDialog",data(){return{isPaid:!1,isTrans:!1,payUrl:"",dialogTableVisible:!1,congratulationsVisible:!1,form:{amount:0,create_time:"AAA",payment_id:"AAA",payment_no:"AAA",status:"AAA",user_id:0},activeIndex:"",loading:!1,info:"",remainingTime:300,maxTime:300,countdownTimer:null}},computed:{timePercentage(){return this.remainingTime/this.maxTime*100}},watch:{dialogTableVisible(e){e||(this.loading=!1,this.isPaid=!1,this.isTrans=!1,this.countdownTimer&&(clearInterval(this.countdownTimer),this.countdownTimer=null))}},methods:{show(e,t){this.form=e,this.info=t||"VIP · 1年",this.dialogTableVisible=!0,this.activeIndex=this.form.payment_no,this.loading=!1,this.startCheckPay(this.form.payment_id),this.startCountdown()},closeCongratulations(){this.congratulationsVisible=!1,this.loading=!1},async CheckPay(e){try{const t=await L.Z.postOrderNoPayCheck2(e);"支付成功"===t&&(this.form.status=t,this.dialogTableVisible=!1,this.congratulationsVisible=!0,clearInterval(this.checkPayInterval),this.countdownTimer&&(clearInterval(this.countdownTimer),this.countdownTimer=null),this.$message.success("恭喜您成为邻诗会员！"))}catch(t){console.log(t)}},startCheckPay(e){const t=3e5;let s=0;this.checkPayInterval=setInterval((async()=>{await this.CheckPay(e),s+=5e3,s>=t&&(clearInterval(this.checkPayInterval),console.log("Payment check timeout."),this.form.status="支付失败",this.countdownTimer&&(clearInterval(this.countdownTimer),this.countdownTimer=null))}),5e3)},formatTime(e){const t=Math.floor(e/60),s=e%60;return`${t.toString().padStart(2,"0")}:${s.toString().padStart(2,"0")}`},startCountdown(){this.remainingTime=this.maxTime,this.countdownTimer&&clearInterval(this.countdownTimer),this.countdownTimer=setInterval((()=>{this.remainingTime>0?this.remainingTime-=1:(clearInterval(this.countdownTimer),this.countdownTimer=null)}),1e3)}},beforeUnmount(){this.checkPayInterval&&clearInterval(this.checkPayInterval),this.countdownTimer&&clearInterval(this.countdownTimer)}},q=s(64186);const D=(0,q.Z)(B,[["render",C],["__scopeId","data-v-672539b3"]]);var E=D},3757:function(e,t,s){e.exports=s.p+"img/wxpay.29ad377b.png"}}]);
//# sourceMappingURL=583.f8352e05.js.map