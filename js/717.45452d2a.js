"use strict";(self["webpackChunklin_cms_vvlog"]=self["webpackChunklin_cms_vvlog"]||[]).push([[717],{59717:function(e,t,a){a.r(t),a.d(t,{default:function(){return W}});var s=a(6808),n=a(59511);const i={class:"custom-pagination"},r=["disabled"],o={class:"pagination-info"},d=["disabled"],c={class:"pagination-info"};function l(e,t,a,l,u,h){return(0,s.wg)(),(0,s.iD)("div",i,[(0,s._)("button",{onClick:t[0]||(t[0]=(...e)=>h.prevPage&&h.prevPage(...e)),disabled:1===a.currentPage,class:"pagination-button"},"上一页",8,r),(0,s._)("span",o,"第 "+(0,n.zw)(a.currentPage)+" 页",1),(0,s._)("button",{onClick:t[1]||(t[1]=(...e)=>h.nextPage&&h.nextPage(...e)),disabled:a.currentPage===h.totalPages,class:"pagination-button"},"下一页",8,d),(0,s._)("span",c,"共 "+(0,n.zw)(h.totalPages)+" 页",1)])}var u={props:{currentPage:{type:Number,required:!0},pageSize:{type:Number,required:!0},totalItems:{type:Number,required:!0}},computed:{totalPages(){return Math.ceil(this.totalItems/this.pageSize)}},methods:{prevPage(){this.currentPage>1&&this.$emit("update:currentPage",this.currentPage-1)},nextPage(){this.currentPage<this.totalPages&&this.$emit("update:currentPage",this.currentPage+1)}}},h=a(64186);const g=(0,h.Z)(u,[["render",l],["__scopeId","data-v-0c864d6e"]]);var m=g,p=a(41441);const C=e=>((0,s.dD)("data-v-046733bc"),e=e(),(0,s.Cn)(),e),b={class:"container"},w={class:"wrap"},_=C((()=>(0,s._)("h3",{style:{"font-weight":"bold","font-size":"18px","margin-top":"20px"}},"分享列表：",-1))),f={style:{"margin-top":"20px"}};function y(e,t,a,i,r,o){const d=(0,s.up)("el-button"),c=(0,s.up)("el-col"),l=(0,s.up)("el-input"),u=(0,s.up)("el-row"),h=(0,s.up)("el-table-column"),g=(0,s.up)("el-table"),C=m,y=(0,s.up)("el-form");return(0,s.wg)(),(0,s.iD)("div",b,[(0,s._)("div",w,[(0,s.Wm)(u,null,{default:(0,s.w5)((()=>[(0,s.Wm)(c,{lg:24,md:24,sm:24,xs:24},{default:(0,s.w5)((()=>[(0,s.Wm)(y,{model:r.form,"status-icon":"",ref:"form","label-width":"120px",onSubmit:t[1]||(t[1]=(0,p.iM)((()=>{}),["prevent"]))},{default:(0,s.w5)((()=>[(0,s.Wm)(u,null,{default:(0,s.w5)((()=>[r.form.shareCode?(0,s.kq)("",!0):((0,s.wg)(),(0,s.j4)(c,{key:0,lg:12},{default:(0,s.w5)((()=>[(0,s.Wm)(d,{type:"primary",onClick:o.createShareCode},{default:(0,s.w5)((()=>[(0,s.Uk)("创建分享代码")])),_:1},8,["onClick"])])),_:1})),(0,s.Wm)(c,{lg:24},{default:(0,s.w5)((()=>[(0,s._)("h3",null,"我的分享代码："+(0,n.zw)(r.form.shareCode),1),(0,s.Wm)(u,null,{default:(0,s.w5)((()=>[(0,s.Wm)(c,{span:16},{default:(0,s.w5)((()=>[(0,s.Wm)(l,{modelValue:r.bindShareCodeInput,"onUpdate:modelValue":t[0]||(t[0]=e=>r.bindShareCodeInput=e),placeholder:"输入绑定分享代码（绑定成功可获取2次AI次数）",maxlength:"8",disabled:r.isBindCodeAvailable},null,8,["modelValue","disabled"])])),_:1}),(0,s.Wm)(d,{type:"success",onClick:o.bindShareCode},{default:(0,s.w5)((()=>[(0,s.Uk)("绑定分享代码")])),_:1},8,["onClick"])])),_:1}),_,(0,s.Wm)(g,{data:r.shareList,style:{width:"100%"}},{default:(0,s.w5)((()=>[(0,s.Wm)(h,{prop:"share_code",label:"分享代码"}),(0,s.Wm)(h,{prop:"share_user_name",label:"分享用户"}),(0,s.Wm)(h,{prop:"create_time",label:"创建时间"})])),_:1},8,["data"]),(0,s._)("div",f,[(0,s.Wm)(C,{currentPage:r.page_number,pageSize:r.page_size,totalItems:r.count,"onUpdate:currentPage":o.handleCurrentChange},null,8,["currentPage","pageSize","totalItems","onUpdate:currentPage"])])])),_:1})])),_:1})])),_:1},8,["model"])])),_:1})])),_:1})])])}var P=a(26554);class S{async getSettingByKey(e){const t=await(0,P.U2)(`cms/settings/key/${e}`);return t}async getSettingByKeys(e){const t=await(0,P.U2)("cms/settings/keys",e);return t}async setSettingValues(e){const t=await(0,P.v_)("cms/settings/set-values",e);return t}async createShareCode(){const e=await(0,P.U2)("cms/share/createcode");return e}async getCode(){const e=await(0,P.U2)("cms/share/getcode");return e}async queryBindCode(){const e=await(0,P.U2)("cms/share/querybindcode");return e}async bindCode(e){const t=await(0,P.U2)("cms/share/bindcode",{ShareCode:e});return t}async getPagedList(e){const t=await(0,P.U2)("cms/share/query",e);return t}}var v=new S,k={name:"ShareSetting",components:{CustomPagination:m},data(){return{form:{shareCode:""},bindShareCodeInput:"",shareList:[],loading:!1,page_number:1,page_size:15,count:0,totalPages:0,isBindCodeAvailable:!1}},async created(){await this.loadInitialData()},methods:{async loadInitialData(){await this.getShareCode(),this.form.shareCode&&await this.fetchShareList();const e=await v.queryBindCode();this.bindShareCodeInput=e},async fetchShareList(){if(this.form.shareCode){this.loading=!0;try{const e=await v.getPagedList({ShareCode:this.form.shareCode,Count:this.page_size,Page:this.page_number-1});this.shareList=e.items,this.count=e.count,this.totalPages=Math.ceil(this.count/this.page_size),this.page_number>this.totalPages&&(this.page_number=this.totalPages)}catch(e){this.$message.error("加载分享列表失败，请重试。")}finally{this.loading=!1}}else this.$message.warning("请先创建自己的分享代码")},async createShareCode(){this.form.shareCode=await v.createShareCode(),this.$message.success(`创建的分享代码: ${code}`),await this.loadInitialData()},async getShareCode(){const e=await v.getCode();this.form.shareCode=e},async bindShareCode(){const e=await v.bindCode(this.bindShareCodeInput);this.$message.success(e),await this.fetchShareList()},handleCurrentChange(e){this.page_number=e,this.fetchShareList()}}};const I=(0,h.Z)(k,[["render",y],["__scopeId","data-v-046733bc"]]);var W=I}}]);
//# sourceMappingURL=717.45452d2a.js.map